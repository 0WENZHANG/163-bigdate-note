## 行转列业务场景

业务场景：用户分析

要做用户分析，但是原始数据中及记录的是每条日志详情，内容如下：

| 用户id | 购买商品id |
|:-----:|:---------:|
| 001 | Product1 |
| 001 | Product1 |
| 001 | Product1 |
| 001 | Product1 |
| 001 | Product1 |
| 001 | Product1 |
| ..... | ..... |

这个粒度太细，不便于我们分析，我们其实想得到的可能是用户维度的数据，类似下面这种：

| 用户id | 购买商品id |
|:-----:|:---------:|
| 001 | Product1, Product2, product3 |
| 002 | Product1, Product2, product3 |
| ... | ... |

也就是把它聚合成每个用户为一行，把一个用户购买的所有商品都聚合到一个字段中，这其实就是行转列的操作。

## Hive中行转列函数

>collect_set()： 不插入重复记录

> collect_list(): 保留重复记录

